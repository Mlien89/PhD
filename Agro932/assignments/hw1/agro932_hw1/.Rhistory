setwd("C:/Users/u942451/OneDrive - University of Nebraska-Lincoln/school/PhD/PhD_github/Agro932/assignments/hw1/agro932_hw1")
geno <- read.table("data/geno.txt", header=FALSE)
geno <- read.table("/data/geno.txt", header=FALSE)
geno <- read.table("data/arabidopsis/geno.txt", header=FALSE)
names(geno) <- c("chr", "pos", "ref", "alt", "l1", "l2", "l3", "l4", "l5")
head(geno)
names(geno) <- c("chr", "pos", "ref", "alt", "l1", "l2", "l3", "l4", "l5", "l6", "l7", "l8", "l9", "l10", "l11", "l12", "l13", "l14", "l15", "l16", "l17", "l18", "l19", "l20")
head(geno)
for(i in 5:20){
for(i in 5:20){
# replace slash and everything after it as nothing
geno$newcol <- gsub("/.*", "", geno[,i] )
# extract the line name
nm <- names(geno)[i]
# assign name for this allele
names(geno)[ncol(geno)] <- paste0(nm, sep="_a1")
geno$newcol <- gsub(".*/", "", geno[,i] )
names(geno)[ncol(geno)] <- paste0(nm, sep="_a2")
}
for(i in 5:20){
# replace slash and everything after it as nothing
geno$newcol <- gsub("/.*", "", geno[,i] )
# extract the line name
nm <- names(geno)[i]
# assign name for this allele
names(geno)[ncol(geno)] <- paste0(nm, sep="_a1")
geno$newcol <- gsub(".*/", "", geno[,i] )
names(geno)[ncol(geno)] <- paste0(nm, sep="_a2")
}
View(geno)
View(geno)
geno$p <- apply(geno[, 21:56], 1, function(x) {sum(as.numeric(as.character(x)))})
View(geno)
warnings()
str(geno)
geno$p <- apply(geno[, 21:56], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p <- apply(geno[, 25:56], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p <- geno$p/32
View(geno)
setwd("C:/Users/u942451/OneDrive - University of Nebraska-Lincoln/school/PhD/PhD_github/Agro932/assignments/hw1/agro932_hw1")
geno <- read.table("data/arabidopsis/geno.txt", header=FALSE)
names(geno) <- c("chr", "pos", "ref", "alt", "l1", "l2", "l3", "l4", "l5", "l6", "l7", "l8", "l9", "l10", "l11", "l12", "l13", "l14", "l15", "l16", "l17", "l18", "l19", "l20")
for(i in 5:24){
# replace slash and everything after it as nothing
geno$newcol <- gsub("/.*", "", geno[,i] )
# extract the line name
nm <- names(geno)[i]
# assign name for this allele
names(geno)[ncol(geno)] <- paste0(nm, sep="_a1")
geno$newcol <- gsub(".*/", "", geno[,i] )
names(geno)[ncol(geno)] <- paste0(nm, sep="_a2")
}
geno$p <- apply(geno[, 25:64], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p <- geno$p/40
geno$p1 <- apply(geno[, 25:54], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p1 <- geno$p1/30
geno$p2 <- apply(geno[, 55:64], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p2 <- geno$p2/10
View(geno)
#calculate Fst
geno$fst <- with(geno, ((p1-p)^2) + (p2-p)^2)/(2*p(1-p)))
#calculate Fst
geno$fst <- with(geno, ((p1-p)^2 + (p2-p)^2)/(2*p(1-p)))
str(geno)
#calculate Fst
geno$fst <- with(geno, ((p1-p)^2 + (p2-p)^2)/(2*p(1-p)))
#calculate Fst
geno$fst <- with(geno, ((p1-p)^2 + (p2-p)^2)/(2*p*(1-p)))
#write Fst results
write.table(geno, file = "cache/fst_results.csv", sep = ",", row.names = F, quote = F)
#visualize Fst results
fst <- read.csv("cache/fst_results.csv")
plot(fst$pos, fst$fst, xlab="Physical position", ylab="Fst value", main="")
pdf(file = "graphs/Fst.PDF",   # The directory you want to save the file in
width = 4, # The width of the plot in inches
height = 4) # The height of the plot in inches
plot(fst$pos, fst$fst, xlab="Physical position", ylab="Fst value", main="")
dev.off()
dev.off()
pdf(file = "graphs/Fst.PDF",   # The directory you want to save the file in
width = 2, # The width of the plot in inches
height = 2) # The height of the plot in inches
plot(fst$pos, fst$fst, xlab="Physical position", ylab="Fst value", main="")
dev.off()
pdf(file = "graphs/Fst.PDF",   # The directory you want to save the file in
width = 6, # The width of the plot in inches
height = 6) # The height of the plot in inches
plot(fst$pos, fst$fst, xlab="Physical position", ylab="Fst value", main="")
dev.off()
dev.off()
dev.off()
pdf(file = "graphs/Fst.PDF",   # The directory you want to save the file in
width = 4, # The width of the plot in inches
height = 4) # The height of the plot in inches
plot(fst$pos, fst$fst, xlab="Physical position", ylab="Fst value", main="")
dev.off()
dev.off()
View(fst)
geno$p <- apply(geno[, 25:64], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p <- geno$p/40
geno$p1 <- apply(geno[, 25:34], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p1 <- geno$p1/10
geno$p2 <- apply(geno[, 35:64], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p2 <- geno$p2/30
#calculate Fst
geno$fst <- with(geno, ((p1-p)^2 + (p2-p)^2)/(2*p*(1-p)))
#write Fst results
write.table(geno, file = "cache/fst_results.csv", sep = ",", row.names = F, quote = F)
#visualize Fst results
fst <- read.csv("cache/fst_results.csv")
pdf(file = "graphs/Fst.PDF",   # The directory you want to save the file in
width = 4, # The width of the plot in inches
height = 4) # The height of the plot in inches
plot(fst$pos, fst$fst, xlab="Physical position", ylab="Fst value", main="")
dev.off()
dev.off()
pdf(file = "graphs/Fst.PDF",   # The directory you want to save the file in
width = 4, # The width of the plot in inches
height = 4) # The height of the plot in inches
plot(fst$pos, fst$fst, xlab="Physical position", ylab="Fst value", main="")
dev.off()
dev.off()
dev.off()
pdf(file = "graphs/Fst.PDF",   # The directory you want to save the file in
width = 4, # The width of the plot in inches
height = 4) # The height of the plot in inches
plot(fst$pos, fst$fst, xlab="Physical position", ylab="Fst value", main="")
dev.off()
geno$p <- apply(geno[, 25:64], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p <- geno$p/40
geno$p1 <- apply(geno[, 25:44], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p1 <- geno$p1/20
geno$p2 <- apply(geno[, 45:64], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p2 <- geno$p2/20
#calculate Fst
geno$fst <- with(geno, ((p1-p)^2 + (p2-p)^2)/(2*p*(1-p)))
#write Fst results
write.table(geno, file = "cache/fst_results.csv", sep = ",", row.names = F, quote = F)
#visualize Fst results
fst <- read.csv("cache/fst_results.csv")
pdf(file = "graphs/Fst.PDF",   # The directory you want to save the file in
width = 4, # The width of the plot in inches
height = 4) # The height of the plot in inches
plot(fst$pos, fst$fst, xlab="Physical position", ylab="Fst value", main="")
dev.off()
#.libPaths("C:/Users/u748066/R_libraries")
#setwd("C:/Users/u748066/Downloads/")
#setwd("C:/Users/u748066/OneDrive - Syngenta/Desktop/Stg4+_2021_Sep_2021/")
MAQA01=read.csv(file.choose(), colClasses="character", head=TRUE,  skip=6, na.strings = c("--", "-/-", "-", ""),stringsAsFactors=FALSE)
MAQA02=MAQA01
sum(is.na(MAQA01))
MAQA01[is.na(MAQA01)]="ZZ"
dim(MAQA01)
names(MAQA01)[1:20]
MAQA01[1:3,1:5]
MAQA02[1:3,1:5]
BARCD=MAQA01[,grep("Sample.code|Sample...SPIRIT SubPlot Barcode|Sample...SPIRIT.barcode|SPIRIT.Barcode", names(MAQA01), ignore.case = TRUE)]
BARCD[1:2]
dim(BARCD)
data.class(BARCD)
#BARCD[BARCD==""]=NA
MAQA01=MAQA01[BARCD!="",]
MAQA01=MAQA01[BARCD!="ZZ",]
dim(MAQA01)
head(MAQA01)
source("C:/Users/u942451/OneDrive - Syngenta/Documents/BSS/Projects/Confirmation/MAQA_Rcode_Handover_VEL_to_Mason_2022.R")
MarkerCalls=Syngenta_MAQA(MAQA01)
head(MarkerCalls)
MarkerCalls[1:3,1:7]
MarkerCalls[1:1,]
MarkerCalls=data.frame(MarkerCalls)
table(MarkerCalls$RPS_T)
write.csv(MarkerCalls, file.choose(), row.names = F)
setwd("C:/Users/u942451/OneDrive - University of Nebraska-Lincoln/school/PhD/PhD_github/Agro932/assignments/hw1/agro932_hw1")
geno <- read.table("data/arabidopsis/mutation_10", header=FALSE)
names(geno) <- c("chr", "pos", "ref", "alt", "l1", "l2", "l3", "l4", "l5", "l6", "l7", "l8", "l9", "l10", "l11", "l12", "l13", "l14", "l15", "l16", "l17", "l18", "l19", "l20")
for(i in 5:24){
# replace slash and everything after it as nothing
geno$newcol <- gsub("/.*", "", geno[,i] )
# extract the line name
nm <- names(geno)[i]
# assign name for this allele
names(geno)[ncol(geno)] <- paste0(nm, sep="_a1")
geno$newcol <- gsub(".*/", "", geno[,i] )
names(geno)[ncol(geno)] <- paste0(nm, sep="_a2")
}
geno <- read.table("data/arabidopsis/mutation_10/geno.txt", header=FALSE)
names(geno) <- c("chr", "pos", "ref", "alt", "l1", "l2", "l3", "l4", "l5", "l6", "l7", "l8", "l9", "l10", "l11", "l12", "l13", "l14", "l15", "l16", "l17", "l18", "l19", "l20")
head(geno)
for(i in 5:24){
# replace slash and everything after it as nothing
geno$newcol <- gsub("/.*", "", geno[,i] )
# extract the line name
nm <- names(geno)[i]
# assign name for this allele
names(geno)[ncol(geno)] <- paste0(nm, sep="_a1")
geno$newcol <- gsub(".*/", "", geno[,i] )
names(geno)[ncol(geno)] <- paste0(nm, sep="_a2")
}
geno$p <- apply(geno[, 25:64], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p <- geno$p/40
geno$p1 <- apply(geno[, 25:54], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p1 <- geno$p1/30
geno$p2 <- apply(geno[, 55:64], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p2 <- geno$p2/10
#calculate Fst
geno$fst <- with(geno, ((p1-p)^2 + (p2-p)^2)/(2*p*(1-p)))
#write Fst results
write.table(geno, file = "cache/fst_results_wmutation10.csv", sep = ",", row.names = F, quote = F)
#visualize Fst results
fst <- read.csv("cache/fst_results_wmutation10.csv")
pdf(file = "graphs/Fst.PDF",   # The directory you want to save the file in
width = 4, # The width of the plot in inches
height = 4) # The height of the plot in inches
plot(fst$pos, fst$fst, xlab="Physical position", ylab="Fst value", main="")
dev.off()
dev.off()
plot(fst$pos, fst$fst, xlab="Physical position", ylab="Fst value", main="")
geno <- read.table("data/arabidopsis/mutation_01/geno.txt", header=FALSE)
names(geno) <- c("chr", "pos", "ref", "alt", "l1", "l2", "l3", "l4", "l5", "l6", "l7", "l8", "l9", "l10", "l11", "l12", "l13", "l14", "l15", "l16", "l17", "l18", "l19", "l20")
head(geno)
for(i in 5:24){
# replace slash and everything after it as nothing
geno$newcol <- gsub("/.*", "", geno[,i] )
# extract the line name
nm <- names(geno)[i]
# assign name for this allele
names(geno)[ncol(geno)] <- paste0(nm, sep="_a1")
geno$newcol <- gsub(".*/", "", geno[,i] )
names(geno)[ncol(geno)] <- paste0(nm, sep="_a2")
}
geno$p <- apply(geno[, 25:64], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p <- geno$p/40
geno$p1 <- apply(geno[, 25:54], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p1 <- geno$p1/30
geno$p2 <- apply(geno[, 55:64], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p2 <- geno$p2/10
#calculate Fst
geno$fst <- with(geno, ((p1-p)^2 + (p2-p)^2)/(2*p*(1-p)))
#write Fst results
write.table(geno, file = "cache/fst_results_wmutation01.csv", sep = ",", row.names = F, quote = F)
#visualize Fst results with mutation rate of 0.01
fst <- read.csv("cache/fst_results_wmutation01.csv")
pdf(file = "graphs/Fst.PDF",   # The directory you want to save the file in
width = 4, # The width of the plot in inches
height = 4) # The height of the plot in inches
pdf(file = "graphs/Fst_wmutation01.PDF",   # The directory you want to save the file in
width = 4, # The width of the plot in inches
height = 4) # The height of the plot in inches
plot(fst$pos, fst$fst, xlab="Physical position", ylab="Fst value", main="")
dev.off()
dev.off()
pdf(file = "graphs/Fst_wmutation01.PDF",   # The directory you want to save the file in
width = 4, # The width of the plot in inches
height = 4) # The height of the plot in inches
plot(fst$pos, fst$fst, xlab="Physical position", ylab="Fst value", main="")
dev.off()
dev.off()
dev.off()
pdf(file = "graphs/Fst_wmutation01.PDF",   # The directory you want to save the file in
width = 4, # The width of the plot in inches
height = 4) # The height of the plot in inches
plot(fst$pos, fst$fst, xlab="Physical position", ylab="Fst value", main="")
dev.off()
dev.off()
setwd("C:/Users/u942451/OneDrive - University of Nebraska-Lincoln/school/PhD/PhD_github/Agro932/assignments/hw1/agro932_hw1")
geno <- read.table("data/arabidopsis/mutation_01/geno.txt", header=FALSE)
names(geno) <- c("chr", "pos", "ref", "alt", "l1", "l2", "l3", "l4", "l5", "l6", "l7", "l8", "l9", "l10", "l11", "l12", "l13", "l14", "l15", "l16", "l17", "l18", "l19", "l20")
head(geno)
for(i in 5:24){
# replace slash and everything after it as nothing
geno$newcol <- gsub("/.*", "", geno[,i] )
# extract the line name
nm <- names(geno)[i]
# assign name for this allele
names(geno)[ncol(geno)] <- paste0(nm, sep="_a1")
geno$newcol <- gsub(".*/", "", geno[,i] )
names(geno)[ncol(geno)] <- paste0(nm, sep="_a2")
}
geno$p <- apply(geno[, 25:64], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p <- geno$p/40
geno$p1 <- apply(geno[, 25:54], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p1 <- geno$p1/30
geno$p2 <- apply(geno[, 55:64], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p2 <- geno$p2/10
#calculate Fst
geno$fst <- with(geno, ((p1-p)^2 + (p2-p)^2)/(2*p*(1-p)))
#write Fst results
write.table(geno, file = "cache/fst_results_wmutation01.csv", sep = ",", row.names = F, quote = F)
#visualize Fst results with mutation rate of 0.01
fst <- read.csv("cache/fst_results_wmutation01.csv")
pdf(file = "graphs/Fst_wmutation01.PDF",   # The directory you want to save the file in
width = 4, # The width of the plot in inches
height = 4) # The height of the plot in inches
plot(fst$pos, fst$fst, xlab="Physical position", ylab="Fst value", main="")
dev.off()
dev.off()
geno <- read.table("data/arabidopsis/mutation_10/geno.txt", header=FALSE)
names(geno) <- c("chr", "pos", "ref", "alt", "l1", "l2", "l3", "l4", "l5", "l6", "l7", "l8", "l9", "l10", "l11", "l12", "l13", "l14", "l15", "l16", "l17", "l18", "l19", "l20")
head(geno)
for(i in 5:24){
# replace slash and everything after it as nothing
geno$newcol <- gsub("/.*", "", geno[,i] )
# extract the line name
nm <- names(geno)[i]
# assign name for this allele
names(geno)[ncol(geno)] <- paste0(nm, sep="_a1")
geno$newcol <- gsub(".*/", "", geno[,i] )
names(geno)[ncol(geno)] <- paste0(nm, sep="_a2")
}
geno$p <- apply(geno[, 25:64], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p <- geno$p/40
geno$p1 <- apply(geno[, 25:54], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p1 <- geno$p1/30
geno$p2 <- apply(geno[, 55:64], 1, function(x) {sum(as.numeric(as.character(x)))})
geno$p2 <- geno$p2/10
#calculate Fst
geno$fst <- with(geno, ((p1-p)^2 + (p2-p)^2)/(2*p*(1-p)))
#write Fst results
write.table(geno, file = "cache/fst_results_wmutation10.csv", sep = ",", row.names = F, quote = F)
#visualize Fst results
fst <- read.csv("cache/fst_results_wmutation10.csv")
pdf(file = "graphs/Fst.PDF",   # The directory you want to save the file in
width = 4, # The width of the plot in inches
height = 4) # The height of the plot in inches
plot(fst$pos, fst$fst, xlab="Physical position", ylab="Fst value", main="")
dev.off()
dev.off()
pdf(file = "graphs/Fst_wmutation10.PDF",   # The directory you want to save the file in
width = 4, # The width of the plot in inches
height = 4) # The height of the plot in inches
plot(fst$pos, fst$fst, xlab="Physical position", ylab="Fst value", main="")
dev.off()
